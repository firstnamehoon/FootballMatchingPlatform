<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kosta.project.repository.UserMapper">
	
  <select id="selectUserLogin" parameterType="java.lang.String" resultType="com.kosta.project.dto.UserDTO">
    SELECT
      user_id,
      address,
      user_tier
    FROM users
    WHERE
      NOW()-suspended_time >= 0
      AND user_id = #{userId}
  </select>

  <select id="selectUserSnsLogin" parameterType="java.lang.String" resultType="com.kosta.project.dto.UserDTO">
    SELECT
      user_id,
      address,
      user_tier
    FROM users
    WHERE
      NOW()-suspended_time >= 0
      AND user_id = #{userId}
  </select>

  <update id="setUserLastLoginDateByUserId" parameterType="java.lang.String">
    UPDATE users
    SET last_login_date = NOW()
    WHERE user_id = #{userId}
  </update>

  <select id="selectUserIdByUserId" parameterType="java.lang.String" resultType="java.lang.String">
    SELECT
      user_id
    FROM users
    WHERE user_id = #{userId}
  </select>
	
	
    <select id="selectUserNicknameByNickname" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT nickname
        FROM users
        WHERE nickname = #{nickname}
    </select>	
	  
	  
  <select id="selectEmailByEmail" resultType="java.lang.String" parameterType="java.lang.String">
    SELECT email
    FROM users
    WHERE email = #{email}
  </select>

  <insert id="insertUserJoin" parameterType="java.lang.String">
    INSERT INTO users(user_id, password, nickname, NAME, birthday, gender, phone_number, email,
        address, game_count, win_count, user_rank, last_login_date, join_date, user_score, report_count,
        suspended_time, user_status)
    VALUES (#{userId}, #{password}, #{nickname}, #{name}, #{birthday}, #{gender}, #{phoneNumber}, #{email},
        #{address}, #{gameCount}, #{winCount}, #{userRank}, #{lastLoginDate}, #{joinDate}, #{userScore}, #{reportCount},
        #{suspendedTime}, #{userStatus})
  </insert>

  <select id="selectIdByNameAndEmail" resultType="java.lang.String" parameterType="java.lang.String">
    SELECT user_id
    FROM users
    WHERE NAME = #{name}
    AND email = #{email}
  </select>

  <select id="selectPasswordByUserIdAndEmail" resultType="java.lang.String" parameterType="java.lang.String">
    SELECT password
    FROM users
    WHERE user_id = #{userId}
    AND email = #{email}
  </select>

  <update id="updatePasswordByUserId" parameterType="java.lang.String"> 
    UPDATE users
    SET PASSWORD = #{password}
    WHERE user_id = #{userId}
  </update>

  <select id="selectTopThreeUsersList" resultType="com.kosta.project.dto.UserDTO">
    SELECT user_rank, nickname, user_score
    FROM users WHERE user_rank <= 3
    AND user_rank >= 1
    order by user_rank desc;
  </select>

  <select id="selectTopHundredUsersList" resultType="com.kosta.project.dto.UserDTO">
    SELECT user_rank, nickname, user_score
    FROM users WHERE user_rank <= 100
    AND user_rank >= 1
    order by user_rank desc;
  </select>

  <select id="selectUserLogin" parameterType="java.lang.String" resultType="com.kosta.project.dto.UserDTO">
    SELECT user_id, address, user_tier
    FROM users
    WHERE NOW() - suspended_time >= 0
      AND user_id = #{userId}
  </select>

  <select id="selectUserSnsLogin" parameterType="java.lang.String" resultType="com.kosta.project.dto.UserDTO">
    SELECT user_id, address, user_tier
    FROM users
    WHERE NOW() - suspended_time >= 0
      AND user_id = #{userId}
  </select>

  <update id="setUserLastLoginDateByUserId" parameterType="java.lang.String">
    UPDATE users
    SET last_login_date = NOW()
    WHERE user_id = #{userId}
  </update>

  <select id="selectUserIdByUserId" parameterType="java.lang.String" resultType="java.lang.String">
    SELECT user_id
    FROM users
    WHERE user_id = #{userId}
  </select>
	
	
	
</mapper>