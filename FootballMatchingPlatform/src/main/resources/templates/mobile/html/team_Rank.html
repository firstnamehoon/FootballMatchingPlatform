<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link rel="stylesheet" href="mobile/css/common.css" />
  <link rel="stylesheet" href="mobile/css/team.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

</head>

<body>
  <!-- 모바일 컨테이너 -->
  <div id="mobile-container">
    <!-- 헤더 -->
	
    <header></header>
    <!-- 컨텐츠 컨테이너 -->
    <div id="container">

      <div class="d-flex gap-2 justify-content-between p-2 pt-2 m-2 mb-0">
        <div class="btnBox">
          <button type="button" class="selectBtn p-2 btnClick" id="allTeamRank">전체 팀 순위</button>
        </div>
        <div class="btnBox">
          <button type="button" class="selectBtn p-2" id="possJoin">가입 가능 팀</button>
        </div>
        <div class="btnBox">
          <button type="button" class="selectBtn p-2" id="joinList">가입 신청 목록</button>
        </div>
      </div>

      <div class="d-flex justify-content-center m-2">
        <div id="row">
          <input id="search-keyword" placeholder="검색어를 입력하세요">
          <img id="search" src="../img/search.svg">
        </div>
      </div>

      <div class="d-flex flex-column gap-2 w-100 p-2" id="dataBox">


      </div>

    </div>
    <!-- 하단 메뉴바 -->
    <nav></nav>
  </div>

  <script>
    // header, nav 내용 불러오기
    $(document).ready(function () {
      $("header").load("./common/header_back.html", function () {
        // 뒤로가기 필요한 페이지는 header_back, 아닌 페이지는 header 사용해주세욤
        $("#page-name").text("팀"); // 해당 페이지 이름 넣어주세욤 ex) 마이페이지
        $("#user-tier").text("B"); // 나중에 세션에서 usertier 구해서 넣기
      });
      $("nav").load("./common/nav.html");
      
      
      // 전체 팀 순위
      fetch("/rank")
	   	 .then(response =>response.json())
	   	 .then(data =>{   	   	 
	   	   	 let res = data.result;
	   	   	 
	   	   	 let str ="";
	   	   	 for(var i in res){
	   	   	 	str += `<div class="content-container border border-2 rounded-4">
          <div class="first-content-container">
            <div class="ranking">`+res[i].teamRank+`</div>
            <div class="name">
              <span class="teamname">`+res[i].teamName+`</span>
            </div>
          </div>
          <div class="second-content-container">
            <div class="gameCount">`+res[i].gameCount+`</div>
            <div class="odds">`+res[i].odds+`</div>
            <div class="tier">`+res[i].teamTier+`</div>
            <div class="score">`+res[i].teamScore+`</div>
          </div>
        </div>
	   	   		 `;
	   	   	 }
	   	   	 $('#dataBox').html(str);

	   	 })
      
    });
    

    $("#searchTeamButton").on("click", function () {
      alert("팀 검색");
    });

    
    $("#possJoin").on('click',function(){
		$(".selectBtn").removeClass('btnClick');
		$(this).addClass('btnClick');
    	
			fetch("/rank")
			.then(response =>response.json())
	   	 	.then(data =>{   	   	 
	   	   		let res = data.result;
	   	   	 
	   	   		let str ="";
	   	   	 	for(var i in res){
	   	   	 		str += `<div class="content-container border border-2 rounded-4">
          			<div class="first-content-container">
			            <div class="ranking">`+res[i].teamRank+`</div>
			            <div class="name">
			              <span class="teamname">`+res[i].teamName+`</span>
			            </div>
			          </div>
			          <div class="second-content-container">
			            <div class="gameCount">`+res[i].gameCount+`</div>
			            <div class="odds">`+res[i].odds+`</div>
			            <div class="tier">`+res[i].teamTier+`</div>
			            <div class="score">`+res[i].teamScore+`</div>
			          </div>
			        </div>`;
	   	   	 	}
	   	   	 $('#dataBox').html(str);

	   	 })
    	
    })

    document.getElementById("searchTeamText").value = "검색어를 입력하세요";
  </script>
</body>

</html>